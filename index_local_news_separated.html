<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Catoosa County Crime & First Responder Activity</title>
  <style>
    :root {
      --gold: #c5a100;
      --black: #000;
      --dk: #111;
      --text: #fff;
      --muted: #ccc;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: var(--black);
      color: var(--text);
    }
    header {
      text-align: center;
      padding: 28px 12px;
      border-bottom: 2px solid var(--gold);
    }
    .logo-wrap {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
      flex-wrap: wrap;
    }
    header img.logo {
      width: 160px;
      height: 160px;
      object-fit: cover;
      border-radius: 50%;
      box-shadow: 0 0 18px rgba(197,161,0,.25);
      background: #222;
    }
    header h1 {
      color: var(--gold);
      font-size: 1.9rem;
      margin: 8px 0 0 0;
      text-align: center;
      font-weight: 800;
      letter-spacing: .3px;
    }
    nav {
      text-align: center;
      background: var(--dk);
      padding: 10px 8px;
      border-bottom: 1px solid var(--gold);
      position: sticky;
      top: 0;
      z-index: 2;
    }
    nav a {
      color: var(--text);
      text-decoration: none;
      margin: 0 14px;
      font-weight: 700;
      padding-bottom: 2px;
      border-bottom: 2px solid transparent;
    }
    nav a:hover { border-bottom-color: var(--gold); color: var(--gold); }
    main { max-width: 1100px; margin: 0 auto; padding: 24px; }
    section { margin-bottom: 28px; }
    h2.sec {
      color: var(--gold);
      text-align: center;
      border-bottom: 1px solid var(--gold);
      padding-bottom: 6px;
      margin-top: 0;
    }
    .card {
      background: var(--dk);
      border: 1px solid rgba(197,161,0,.5);
      border-radius: 10px;
      box-shadow: 0 0 16px rgba(197,161,0,.18);
      padding: 18px;
    }
    /* Scanner */
    #live-scanner audio {
      width: 100%;
      max-width: 480px;
      display: block;
      margin: 10px auto 0;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(197,161,0,.25);
      outline: none;
    }
    /* News sections */
    .source-block { margin-top: 18px; }
    .source-title {
      color: var(--gold);
      font-weight: 800;
      margin: 0 0 12px 0;
      text-align: left;
      font-size: 1.1rem;
    }
    .news-list { display: grid; grid-template-columns: 1fr; gap: 10px; }
    @media (min-width: 680px) {
      .news-list { grid-template-columns: 1fr 1fr; }
    }
    .news-item {
      background: #000;
      border: 1px solid var(--gold);
      border-radius: 8px;
      padding: 10px 12px;
    }
    .news-item a {
      color: var(--gold);
      font-weight: 700;
      text-decoration: none;
    }
    .news-item a:hover { text-decoration: underline; }
    .news-item .meta { color: var(--muted); font-size: .8rem; margin-top: 6px; }
    /* About & Tip */
    #about p {
      color: #ddd; line-height: 1.6;
      margin: 0;
      text-align: center;
      font-size: 1.05rem;
    }
    #tip .btn {
      display: inline-block;
      background: var(--gold);
      color: #000;
      padding: 12px 24px;
      border-radius: 6px;
      font-weight: 800;
      text-decoration: none;
      margin-top: 6px;
    }
    #tip .btn:hover { background: #fff; }
    footer {
      text-align: center;
      padding: 18px 12px;
      border-top: 1px solid var(--gold);
      color: #aaa;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo-wrap">
      <img class="logo" id="siteLogo" alt="Catoosa County Logo">
    </div>
    <h1>Catoosa County Crime & First Responder Activity</h1>
  </header>

  <nav>
    <a href="#news">Local News</a>
    <a href="#live-scanner">Live Scanner</a>
    <a href="#about">About Us</a>
    <a href="#tip">Submit a Tip</a>
  </nav>

  <main>
    <section id="live-scanner" class="card">
      <h2 class="sec">üéß Live Police & Fire Feed (Catoosa County)</h2>
      <audio controls>
        <source src="https://m.broadcastify.com/listen/feed/37819" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <p class="meta" style="text-align:center;margin-top:8px;color:#ccc;">
        Powered by <a href="https://www.broadcastify.com/listen/feed/37819" target="_blank" style="color:#fff;">Broadcastify</a>
      </p>
    </section>

    <section id="news" class="card">
      <h2 class="sec">üì∞ Local News & Activity</h2>

      <div class="source-block">
        <h3 class="source-title">Rome News‚ÄëTribune Headlines</h3>
        <div id="rome-list" class="news-list">Loading‚Ä¶</div>
      </div>

      <div class="source-block">
        <h3 class="source-title">WDEF News 12 Headlines</h3>
        <div id="wdef-list" class="news-list">Loading‚Ä¶</div>
      </div>

      <div class="source-block">
        <h3 class="source-title">WRCB Local 3 Headlines</h3>
        <div id="wrcb-list" class="news-list">Loading‚Ä¶</div>
      </div>

      <div class="source-block">
        <h3 class="source-title">Catoosa County (Various Sources)</h3>
        <div id="catoosa-list" class="news-list">Loading‚Ä¶</div>
      </div>
    </section>

    <section id="about" class="card">
      <h2 class="sec">üìç About Us</h2>
      <p>
        A North Georgia resident for the last 17 years who is focused on crime and first responder incidences
        involving our local community members in Catoosa County and surrounding areas.
      </p>
    </section>

    <section id="tip" class="card" style="text-align:center;">
      <h2 class="sec">üì© Submit a Tip</h2>
      <a class="btn" href="mailto:catoosacountyactivity@gmail.com">Send Email Tip</a>
    </section>
  </main>

  <footer>
    ¬© 2025 Catoosa County Crime & First Responder Activity ‚Äî All Rights Reserved
  </footer>

  <script>
    // --- Robust logo loader: tries multiple common filenames, stops on first that exists.
    (function loadLogo() {
      const candidates = [
        "logo.png",
        "Logo.png",
        "logo.jpg",
        "logo.jpeg",
        "images/logo.png",
        "assets/logo.png",
        "4A65C6A1-35B5-4751-8737-81FD7772C090.png" // uploaded filename fallback
      ];
      const imgEl = document.getElementById("siteLogo");
      let idx = 0;
      function tryNext() {
        if (idx >= candidates.length) { imgEl.alt = "Logo"; return; }
        const src = candidates[idx++];
        const test = new Image();
        test.onload = function() { imgEl.src = src; };
        test.onerror = tryNext;
        test.src = src + ((src.indexOf("?")===-1) ? "?v=" + Date.now() : "");
      }
      tryNext();
    })();

    // --- Helper to fetch and render a Google News RSS feed via AllOrigins
    async function fetchFeed(url, limit=6) {
      try {
        const resp = await fetch("https://api.allorigins.win/get?url=" + encodeURIComponent(url));
        const data = await resp.json();
        const parser = new DOMParser();
        const xml = parser.parseFromString(data.contents, "text/xml");
        const items = xml.querySelectorAll("item");
        return Array.from(items).slice(0, limit).map(item => ({
          title: item.querySelector("title")?.textContent || "Untitled",
          link: item.querySelector("link")?.textContent || "#",
          pubDate: new Date(item.querySelector("pubDate")?.textContent || Date.now()).toLocaleString()
        }));
      } catch (e) {
        console.error("Feed error:", e);
        return [];
      }
    }

    function renderList(listElId, stories) {
      const el = document.getElementById(listElId);
      if (!stories || stories.length === 0) {
        el.innerHTML = "<p style='color:var(--muted);'>No recent stories found.</p>";
        return;
      }
      el.innerHTML = stories.map(s => (
        `<div class="news-item">
           <a href="${s.link}" target="_blank" rel="noopener">${s.title}</a>
           <div class="meta">Published: ${s.pubDate}</div>
         </div>`
      )).join("");
    }

    // --- Source queries (separate headers)
    const FEEDS = {
      // Rome News-Tribune (domain: northwestgeorgianews.com)
      rome: "https://news.google.com/rss/search?q=site:northwestgeorgianews.com+(Catoosa+OR+Ringgold+OR+%22Fort+Oglethorpe%22+OR+Chickamauga+OR+%22Walker+County%22)&hl=en-US&gl=US&ceid=US:en",
      // WDEF Chattanooga
      wdef: "https://news.google.com/rss/search?q=site:wdef.com+(Catoosa+OR+Ringgold+OR+%22Fort+Oglethorpe%22+OR+Chickamauga+OR+%22Walker+County%22)&hl=en-US&gl=US&ceid=US:en",
      // WRCB Local3
      wrcb: "https://news.google.com/rss/search?q=site:local3news.com+(Catoosa+OR+Ringgold+OR+%22Fort+Oglethorpe%22+OR+Chickamauga+OR+%22Walker+County%22)&hl=en-US&gl=US&ceid=US:en",
      // General Catoosa County
      catoosa: "https://news.google.com/rss/search?q=%22Catoosa+County%22+Georgia+OR+Ringgold+OR+%22Fort+Oglethorpe%22+OR+Chickamauga+OR+%22Walker+County%22&hl=en-US&gl=US&ceid=US:en"
    };

    async function loadAllNews() {
      const [rome, wdef, wrcb, catoosa] = await Promise.all([
        fetchFeed(FEEDS.rome, 6),
        fetchFeed(FEEDS.wdef, 6),
        fetchFeed(FEEDS.wrcb, 6),
        fetchFeed(FEEDS.catoosa, 6)
      ]);
      renderList("rome-list", rome);
      renderList("wdef-list", wdef);
      renderList("wrcb-list", wrcb);
      renderList("catoosa-list", catoosa);
    }
    loadAllNews();
  </script>
</body>
</html>